<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:FullCrisis3"
             x:Class="FullCrisis3.GameView"
             x:DataType="vm:GameViewModel">

  <Grid RowDefinitions="Auto,*" ColumnDefinitions="Auto,2*,*">
    <!-- Save/Quit Buttons (2 rows) -->
    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Vertical" 
                HorizontalAlignment="Left" Margin="15,15,0,0" Spacing="5">
      <Button x:Name="SaveButton" Content="Save" Background="#FF4CAF50" Classes="CustomButton" 
              FontSize="11" Padding="8,4" Width="60" Command="{Binding SaveGameCommand}" />
      <Button x:Name="QuitButton" Content="Quit" Background="#FFD32F2F" Classes="CustomButton" 
              FontSize="11" Padding="8,4" Width="60" Command="{Binding QuitGameCommand}" />
      <TextBlock Text="{Binding LastSavedText}" FontSize="9" Foreground="#FFAAAAAA" 
                 TextWrapping="Wrap" Width="60" Margin="0,3,0,0" />
    </StackPanel>
    
    <!-- Main Game Area -->
    <Grid Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" RowDefinitions="Auto,2*,*" ColumnDefinitions="3*,2*">
      
      <!-- Story Title -->
      <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="{Binding DialogueTitle}" Classes="Title" 
                 FontSize="20" Margin="0,10,0,15" HorizontalAlignment="Center" />
      
      <!-- Main Story Text Area (Center-Left) -->
      <Border Grid.Row="1" Grid.Column="0" 
              Background="#FF2A3B47" 
              BorderBrush="#FF6B7280" 
              BorderThickness="2" 
              CornerRadius="10" 
              Padding="20" Margin="0,0,10,0">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
          <TextBlock Text="{Binding DialogueText}" 
                     FontSize="15" Foreground="White" TextWrapping="Wrap" 
                     LineHeight="22" />
        </ScrollViewer>
      </Border>
      
      <!-- Character/Speaker Area (Lower-Right) -->
      <Border Grid.Row="1" Grid.Column="1" 
              Background="#FF1F2937" 
              BorderBrush="#FF6B7280" 
              BorderThickness="2" 
              CornerRadius="10" 
              Padding="15" Margin="0,0,0,0">
        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
          <Ellipse Width="80" Height="80" Fill="#FF4B5563" Margin="0,0,0,10" />
          <TextBlock Text="[Character]" FontSize="12" Foreground="#FFAAAAAA" 
                     HorizontalAlignment="Center" />
          <TextBlock Text="Placeholder for future character portraits and speaker info" 
                     FontSize="10" Foreground="#FF666666" TextWrapping="Wrap" 
                     HorizontalAlignment="Center" TextAlignment="Center" Margin="0,5,0,0" />
        </StackPanel>
      </Border>
      
      <!-- Decisions/Input Area (Lower-Left) -->
      <Border Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
              Background="#FF374151" 
              BorderBrush="#FF6B7280" 
              BorderThickness="2" 
              CornerRadius="10" 
              Padding="20" Margin="0,10,0,0">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
          <StackPanel Spacing="15">
            
            <!-- Text Input Section -->
            <StackPanel Spacing="10" IsVisible="{Binding ShowInputControls}">
              <TextBlock Text="{Binding InputPrompt}" FontSize="13" Foreground="#FFCCCCCC" />
              <TextBox x:Name="PlayerInputTextBox" Text="{Binding PlayerInput}" FontSize="13" 
                       Background="#FF3A4D5A" Foreground="White" BorderBrush="#FF6B7280" 
                       BorderThickness="2" CornerRadius="5" Padding="8,6" 
                       Watermark="Type your answer here..." />
              <Button x:Name="SubmitInputButton" Content="Continue" Background="#FF2E7D32" Classes="CustomButton" 
                      FontSize="13" Padding="12,6" HorizontalAlignment="Left"
                      Command="{Binding SubmitInputCommand}" />
            </StackPanel>
            
            <!-- Choice Buttons Section -->
            <StackPanel Spacing="10" IsVisible="{Binding ShowChoiceButtons}">
              <TextBlock Text="Choose your action:" FontSize="13" Foreground="#FFCCCCCC" />
              <StackPanel Spacing="8">
                <Button x:Name="Choice1Button" Content="{Binding Choice1Text}" Background="#FF1976D2" Classes="CustomButton" 
                        FontSize="13" Padding="12,8" HorizontalAlignment="Stretch"
                        Command="{Binding Choice1Command}" IsVisible="{Binding ShowChoice1}" />
                <Button x:Name="Choice2Button" Content="{Binding Choice2Text}" Background="#FFF57C00" Classes="CustomButton" 
                        FontSize="13" Padding="12,8" HorizontalAlignment="Stretch"
                        Command="{Binding Choice2Command}" IsVisible="{Binding ShowChoice2}" />
                <Button x:Name="Choice3Button" Content="{Binding Choice3Text}" Background="#FF7B1FA2" Classes="CustomButton" 
                        FontSize="13" Padding="12,8" HorizontalAlignment="Stretch"
                        Command="{Binding Choice3Command}" IsVisible="{Binding ShowChoice3}" />
              </StackPanel>
            </StackPanel>
            
            <!-- Dropdown Selection Section -->
            <StackPanel Spacing="10" IsVisible="{Binding ShowDropdown}">
              <TextBlock Text="Select your approach:" FontSize="13" Foreground="#FFCCCCCC" />
              <ComboBox x:Name="DropdownComboBox" ItemsSource="{Binding AvailableChoices}" 
                        SelectedItem="{Binding SelectedChoice}"
                        FontSize="13" Background="#FF3A4D5A" Foreground="White" 
                        BorderBrush="#FF6B7280" BorderThickness="2" CornerRadius="5" 
                        Padding="8,6" MinHeight="35">
                <ComboBox.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding Text}" />
                  </DataTemplate>
                </ComboBox.ItemTemplate>
              </ComboBox>
              <Button x:Name="SubmitDropdownButton" Content="Continue" Background="#FF2E7D32" Classes="CustomButton" 
                      FontSize="13" Padding="12,6" HorizontalAlignment="Left"
                      Command="{Binding SubmitInputCommand}" />
            </StackPanel>
            
            <!-- Continue Button Section -->
            <Button x:Name="ContinueButton" Content="Continue" Background="#FF2E7D32" Classes="CustomButton" 
                    FontSize="14" Padding="15,8" HorizontalAlignment="Center"
                    Command="{Binding ContinueCommand}" IsVisible="{Binding ShowContinueButton}" />
            
            <!-- Game Complete Section -->
            <StackPanel Spacing="12" IsVisible="{Binding IsGameComplete}">
              <Border Background="#FF4CAF50" CornerRadius="8" Padding="12">
                <TextBlock Text="ðŸŽ‰ Story Complete! ðŸŽ‰" FontSize="16" Foreground="White" 
                           FontWeight="Bold" HorizontalAlignment="Center" />
              </Border>
              <Button x:Name="BackToMenuButton" Content="Back to Main Menu" Background="#FF6B7280" Classes="CustomButton" 
                      FontSize="14" Padding="15,8" HorizontalAlignment="Center"
                      Command="{Binding BackToMenuCommand}" />
            </StackPanel>
            
          </StackPanel>
        </ScrollViewer>
      </Border>
      
    </Grid>
  </Grid>
</UserControl>